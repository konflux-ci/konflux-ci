apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
- deployment.yaml
- namespace.yaml
- rbac.yaml
- service.yaml
- certificate.yaml
- network_policy_allow_to_apiserver.yaml
- network_policy_allow_from_konfluxui.yaml
- deny-virtual-domain.yaml
namespace: namespace-lister
images:
- digest: sha256:e4bb09dfe4513cdbe349507495c7f4044623a3c2aff866b7946d941e82a7a639
  name: quay.io/konflux-ci/namespace-lister
  newName: quay.io/konflux-ci/namespace-lister
patches:
# Prevent deployment failures during slow dependency setup
- target:
    group: apps
    version: v1
    kind: Deployment
  patch: |-
    - op: add
      path: /spec/progressDeadlineSeconds
      value: 2147483647
- path: ./patches/with_header_auth_user.yaml
  target:
    group: apps
    kind: Deployment
    name: namespace-lister
    namespace: namespace-lister
- path: ./patches/with_header_auth_groups.yaml
  target:
    group: apps
    kind: Deployment
    name: namespace-lister
    namespace: namespace-lister
