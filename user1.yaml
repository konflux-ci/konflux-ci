---
apiVersion: v1
kind: Namespace
metadata:
  name: user-ns1
---
apiVersion: v1
kind: Namespace
metadata:
  name: user-ns2
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  annotations:
    argocd.argoproj.io/sync-options: SkipDryRunOnMissingResource=true
  name: user-ns1
  namespace: user-ns1
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: admin
subjects:
- kind: User
  name: user1
  apiGroup: rbac.authorization.k8s.io
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  annotations:
    argocd.argoproj.io/sync-options: SkipDryRunOnMissingResource=true
  name: user-ns2
  namespace: user-ns2
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: admin
subjects:
- kind: User
  name: user1
  apiGroup: rbac.authorization.k8s.io
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: list-namespaces
rules:
- apiGroups: [""]
  resources: ["namespaces"]
  verbs: ["get", "list"]
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: user1-list-namespaces
subjects:
- kind: User
  name: user1
  apiGroup: rbac.authorization.k8s.io
roleRef:
  kind: ClusterRole
  name: list-namespaces
  apiGroup: rbac.authorization.k8s.io
---
kind: ClusterRole
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: appstudio-admin-user-actions
rules:
  - verbs:
      - get
      - list
      - watch
      - create
      - update
      - patch
      - delete
      - deletecollection
    apiGroups:
      - appstudio.redhat.com
    resources:
      - applications
      - components
      - componentdetectionqueries
  - verbs:
      - get
      - list
      - watch
      - create
      - update
      - patch
      - delete
    apiGroups:
      - appstudio.redhat.com
    resources:
      - promotionruns
      - snapshotenvironmentbindings
      - snapshots
      - environments
  - verbs:
      - get
      - list
      - watch
      - create
      - update
      - patch
      - delete
    apiGroups:
      - appstudio.redhat.com
    resources:
      - deploymenttargets
      - deploymenttargetclaims
  - verbs:
      - get
      - list
      - watch
    apiGroups:
      - managed-gitops.redhat.com
    resources:
      - gitopsdeployments
      - gitopsdeploymentmanagedenvironments
      - gitopsdeploymentrepositorycredentials
      - gitopsdeploymentsyncruns
  - verbs:
      - get
      - list
      - watch
      - create
      - update
      - patch
      - delete
    apiGroups:
      - tekton.dev
    resources:
      - pipelineruns
  - verbs:
      - get
      - list
    apiGroups:
      - results.tekton.dev
    resources:
      - results
      - records
      - logs
  - verbs:
      - get
      - list
      - watch
      - create
      - update
      - patch
      - delete
    apiGroups:
      - appstudio.redhat.com
    resources:
      - enterprisecontractpolicies
      - integrationtestscenarios
      - releases
      - releasestrategies
      - releaseplans
      - releaseplanadmissions
  - verbs:
      - get
      - list
      - watch
      - create
      - update
      - patch
      - delete
    apiGroups:
      - jvmbuildservice.io
    resources:
      - jbsconfigs
      - artifactbuilds
  - verbs:
      - get
      - list
      - watch
      - create
      - update
      - patch
      - delete
    apiGroups:
      - appstudio.redhat.com
    resources:
      - spiaccesstokenbindings
      - spiaccesschecks
      - spiaccesstokens
      - spifilecontentrequests
      - spiaccesstokendataupdates
  - verbs:
      - get
      - list
      - watch
      - create
      - update
      - patch
      - delete
    apiGroups:
      - appstudio.redhat.com
    resources:
      - remotesecrets
  - verbs:
      - get
      - list
      - watch
      - create
      - update
      - patch
      - delete
    apiGroups:
      - ''
    resources:
      - secrets
  - verbs:
      - get
      - list
      - watch
      - create
      - update
      - patch
      - delete
    apiGroups:
      - ''
    resources:
      - configmaps
  - verbs:
      - get
      - list
      - watch
      - create
      - update
      - patch
      - delete
    apiGroups:
      - appstudio.redhat.com
    resources:
      - buildpipelineselectors
  - verbs:
      - get
      - list
      - watch
      - update
      - patch
    apiGroups:
      - ''
    resources:
      - serviceaccounts
    resourceNames:
      - appstudio-pipeline
  - verbs:
      - create
    apiGroups:
      - ''
    resources:
      - pods/exec
  - verbs:
      - get
      - list
      - watch
      - create
      - update
      - patch
      - delete
    apiGroups:
      - toolchain.dev.openshift.com
    resources:
      - spacebindingrequests
  - verbs:
      - get
      - list
      - watch
      - create
      - update
      - patch
      - delete
    apiGroups:
      - projctl.konflux.dev
    resources:
      - projects
      - projectdevelopmentstreams
      - projectdevelopmentstreamtemplates
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: user-appstudio-admin
  namespace: user-ns1
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: appstudio-admin-user-actions
subjects:
- kind: User
  name: user1
  apiGroup: rbac.authorization.k8s.io
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: user-appstudio-admin
  namespace: user-ns2
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: appstudio-admin-user-actions
subjects:
- kind: User
  name: user1
  apiGroup: rbac.authorization.k8s.io
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: user-appstudio-admin-gbenhaim
  namespace: user-ns1
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: appstudio-admin-user-actions
subjects:
- kind: User
  name: gbenhaim
  apiGroup: rbac.authorization.k8s.io
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: user-appstudio-admin-gbenhaim
  namespace: user-ns2
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: appstudio-admin-user-actions
subjects:
- kind: User
  name: gbenhaim
  apiGroup: rbac.authorization.k8s.io

---
kind: ClusterRole
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: self-access-reviewer
rules:
  - verbs:
      - create
      - list
    apiGroups:
      - authorization.k8s.io
    resources:
      - selfsubjectaccessreviews
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: user1-self-access-review
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: self-access-reviewer
subjects:
- kind: User
  name: user1
  apiGroup: rbac.authorization.k8s.io
